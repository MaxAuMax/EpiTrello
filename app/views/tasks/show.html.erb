<turbo-frame id="task_details">
  <div class="task-details-content">
    <h2 class="task-title-main"><%= @task.title %></h2>
    
    <!-- Status Badge -->
    <div class="task-detail-row">
      <span class="task-detail-label">Status</span>
      <span class="task-status-badge" style="background: <%= case @task.task_status&.name
        when 'Backlog' then 'var(--color-slate-100)'
        when 'To Do' then 'rgba(59, 130, 246, 0.1)'
        when 'In Progress' then 'rgba(251, 146, 60, 0.1)'
        when 'Completed' then 'rgba(34, 197, 94, 0.1)'
        when 'On Hold' then 'rgba(239, 68, 68, 0.1)'
        else 'var(--color-slate-100)'
      end %>; color: <%= case @task.task_status&.name
        when 'Backlog' then 'var(--color-slate-600)'
        when 'To Do' then 'var(--color-blue-500)'
        when 'In Progress' then 'var(--color-orange-600)'
        when 'Completed' then 'var(--color-green-600)'
        when 'On Hold' then 'var(--color-red-600)'
        else 'var(--color-slate-600)'
      end %>;">
        <%= @task.task_status&.name || "No status" %>
      </span>
    </div>

    <!-- Description -->
    <% if @task.description.present? %>
      <div class="task-detail-row">
        <span class="task-detail-label">Description</span>
        <p class="task-detail-text"><%= @task.description %></p>
      </div>
    <% end %>

    <!-- Due Date -->
    <% if @task.due_date.present? %>
      <div class="task-detail-row">
        <span class="task-detail-label">Due Date</span>
        <div class="task-detail-meta">
          <svg style="width: 16px; height: 16px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
          <%= @task.due_date.strftime("%B %d, %Y") %>
        </div>
      </div>
    <% end %>

    <!-- Assignee -->
    <% if @task.assignee.present? %>
      <div class="task-detail-row">
        <span class="task-detail-label">Assigned to</span>
        <div class="task-assignee-detail">
          <div class="task-assignee-avatar-large">
            <%= @task.assignee.username.first.upcase %>
          </div>
          <span class="task-assignee-name"><%= @task.assignee.username %></span>
        </div>
      </div>
    <% end %>

    <!-- Actions -->
    <div class="task-modal-actions">
      <%= link_to edit_project_task_path(@task.project, @task), class: 'btn btn-secondary btn-sm' do %>
        <svg style="width: 16px; height: 16px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
        Edit
      <% end %>
      <%= link_to project_task_path(@task.project, @task), 
          data: { turbo_method: :delete, turbo_confirm: 'Are you sure you want to delete this task?' },
          class: 'btn btn-secondary btn-sm task-delete-btn' do %>
        <svg style="width: 16px; height: 16px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="3 6 5 6 21 6"></polyline>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        </svg>
        Delete
      <% end %>
    </div>
  </div>
</turbo-frame>

<style>
turbo-frame#task_details {
  display: block;
}

.task-details-content {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-lg);
}

.task-title-main {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--color-slate-900);
  margin: 0 0 var(--spacing-sm) 0;
}

.task-detail-row {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
}

.task-detail-label {
  font-size: 0.75rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--color-slate-500);
}

.task-status-badge {
  display: inline-flex;
  align-items: center;
  padding: var(--spacing-sm) var(--spacing-md);
  border-radius: var(--radius-md);
  font-size: 0.875rem;
  font-weight: 600;
  width: fit-content;
}

.task-detail-text {
  font-size: 0.9375rem;
  line-height: 1.6;
  color: var(--color-slate-700);
  margin: 0;
}

.task-detail-meta {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  font-size: 0.875rem;
  color: var(--color-slate-600);
  font-weight: 500;
  padding: var(--spacing-sm) var(--spacing-md);
  background: var(--color-slate-50);
  border-radius: var(--radius-md);
  width: fit-content;
}

.task-detail-meta svg {
  flex-shrink: 0;
}

.task-assignee-detail {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
}

.task-assignee-avatar-large {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--color-blue-500) 0%, var(--color-purple-500) 100%);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
  font-weight: 700;
}

.task-assignee-name {
  font-size: 0.9375rem;
  font-weight: 500;
  color: var(--color-slate-700);
}

.task-modal-actions {
  display: flex;
  gap: var(--spacing-sm);
  padding-top: var(--spacing-md);
  border-top: 1px solid var(--color-slate-200);
}

.task-delete-btn:hover {
  background: var(--color-red-50) !important;
  color: var(--color-red-600) !important;
}
</style>
